<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />
		<style type="text/css">
			.mui-content {
				margin-bottom: 51px;
			}
			
			.mui-action-back {
				color: #EFEFF4;
			}
			
			.mui-title {
				color: #EFEFF4;
			}
		</style>
	</head>

	<body>
		<div class="mui-content" id="playinfo">
			<header class="mui-bar mui-bar-transparent">
				<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			</header>
			<div>
				<h1 class="mui-title mui-bar-transparent">{{title}}</h1>
				<video width="100%" height="" id="video" poster="" :src="source" autoplay="autoplay" controls>
				</video>
			</div>
			<div>
				<h4 style="background-color:#efeff4;padding: 6px;">详情</h4>
			</div>
			<div class="detail">
				<img :src="img" width="100%" height="240px" />
				<p>{{detail}}</p>
			</div>
		</div>

		<script src="../js/mui.min.js"></script>
		<script src="../js/vue.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			mui.init()
			var vm = new Vue({
				el: '#playinfo',
				data: {
					title: '',
					source: '',
					img: '',
					detail: ''
				}
			})
			var playid = window.location.search.substring(1).split("=")[1] || "";
			mui.ajax("../video.json", {
				data: {
					playid: ''
				},
				type: 'get', //http请求类型
				dataType: 'json', //服务器返回数据类型
				timeout: 10000, //超时时间
				success: function(data) {
					vm.source = data.resource,
						vm.img = data.image,
						vm.title = data.title,
						vm.detail = data.detail
					setTimeout(function() {
						//广告时间。。。
					}, 1000)
				},
				error: function(xhr, type, errorThrown) {
					mui.toast("请求资源报错<br/>错误类型：" + type)
				}
			})
		</script>
		<script type="text/javascript">
			/**
			 * 视频全屏播放旋转目前的逻辑
			 * 视频全屏，即锁定屏幕为横屏。
			 * 视频恢复，则解除屏幕方向的锁定。
			 * 具体的切换，根据自己的实际业务做相应的操作。
			 */
			// Android平台的视频全屏旋转
			var fullScreenOfAndroid = function() {
				if(true) {
					// 最新5+API的支持
					var self = plus.webview.currentWebview();
					self.setStyle({
						videoFullscreen: 'landscape'
					});
				} else {
					// 如果暂未更新sdk，可以先使用差量升级等方式，做出兼容处理；
					// 旧版本下的兼容处理
					document.addEventListener('webkitfullscreenchange', function() {
						var el = document.webkitFullscreenElement; //获取全屏元素
						if(el) {
							plus.screen.lockOrientation('landscape'); //锁死屏幕方向为横屏
						} else {
							plus.screen.unlockOrientation(); //解除屏幕方向的锁定
						}
					});

				}
			};
			// iOS平台的视频全屏旋转
			var fullScreenOfIos = function(videoElem) {
				// 监听的事件与Android平台有很大区别
				videoElem.addEventListener('webkitbeginfullscreen', function() {
					plus.screen.lockOrientation('landscape'); //锁死屏幕方向为横屏
				});
				videoElem.addEventListener('webkitendfullscreen', function() {
					plus.screen.unlockOrientation(); //解除屏幕方向的锁定
				});
			};
			// 涉及到5+API的内容，均在plusready事件后调用；
			document.addEventListener('plusready', function() {
				var osName = plus.os.name;
				if(osName === 'Android') {
					fullScreenOfAndroid();
				} else if(osName === 'iOS') {
					var videoElem = document.getElementById('video');
					fullScreenOfIos(videoElem);
				}
			});
		</script>
	</body>

</html>