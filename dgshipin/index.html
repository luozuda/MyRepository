<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>首页</title>
		<script src="js/mui.min.js"></script>
		<link href="css/mui.min.css" rel="stylesheet" />
		<style type="text/css">
			.header {
				background-color: #FFFFFF;
				-webkit-box-shadow: none;
				box-shadow: none;
			}
			
			.mui-content {
				margin-bottom: 50px;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav header">
			<div class="mui-input-row mui-search">
				<input type="search" class="mui-input-clear" placeholder="没有喜欢的视频，搜索一下吧" disabled>
			</div>
		</header>
		<div class="mui-content" id="lists">
			<div id="slider" class="mui-slider">
				<div class="mui-slider-group mui-slider-loop">
					<!-- 额外增加的一个节点(循环轮播：第一个节点是最后一张轮播) -->
					<div class="mui-slider-item mui-slider-item-duplicate" v-for="(item,index) in items" v-if="index==3">
						<a @tap="play(item.id)">
							<img :src="'images/'+item.image">
							<p class="mui-slider-title">{{item.title}}</p>
						</a>
					</div>
					<div class="mui-slider-item" v-for="(item,index) in items" v-if="index<=3">
						<a @tap="play(item.id)">
							<img :src="'images/'+item.image">
							<p class="mui-slider-title">{{item.title}}</p>
						</a>
					</div>
					<!-- 额外增加的一个节点(循环轮播：最后一个节点是第一张轮播) -->
					<div class="mui-slider-item mui-slider-item-duplicate" v-for="(item,index) in items" v-if="index==0">
						<a @tap="play(item.id)">
							<img :src="'images/'+item.image">
							<p class="mui-slider-title">{{item.title}}</p>
						</a>
					</div>
				</div>
				<div class="mui-slider-indicator mui-text-right">
					<div class="mui-indicator mui-active"></div>
					<div class="mui-indicator"></div>
					<div class="mui-indicator"></div>
					<div class="mui-indicator"></div>
				</div>
			</div>
			<div id="slider2">
				<h4 style="background-color:#efeff4;padding: 6px;">特别推荐</h4>
				<ul class="mui-table-view mui-grid-view">
					<li v-for="(item,author) in items" v-if="item.follow" class="mui-table-view-cell mui-media mui-col-xs-6">
						<a @tap="play(item.id)">
							<img class="mui-media-object" :src="'images/'+item.image">
							<div class="mui-media-body">
								<span class="mui-ellipsis mui-pull-left"><strong>{{item.title}}</strong> /{{item.actor}}</span>
							</div>
						</a>
					</li>
				</ul>
			</div>
		</div>
		<script src="js/vue.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/index.js" type="text/javascript" charset="utf-8"></script>
		<script src=" js/util.js "></script>
		<script type="text/javascript ">
			(function() {
				mui.init({
					swipeBack: true, //启用右滑关闭功能

					pullRefresh: { //下拉刷新
						container: "#refreshContainer",
						down: {
							style: 'circle',
							callback: function() {
								//业务代码，ajax。。。。
								mui("#refreshContainer").pullRefresh().endPulldownToRefresh(); //停止下拉刷新
							}
						},
						up: {
							contentrefresh: '正在加载...',
							contentnomore: '没有更多数据了',
							callback: function() {
								//业务代码，ajax。。。。
								mui("#refreshContainer").pullRefresh().endPullupToRefresh();
								mui.toast("暂无更多数据");
							}
						}
					}
				});
				mui.plusReady(function() {

					// 创建子webview窗口 并初始化
					var aniShow = {};
					util.initSubpage(aniShow);

					var nview = plus.nativeObj.View.getViewById('tabBar'),
						activePage = plus.webview.currentWebview(),
						targetPage,
						subpages = util.options.subpages,
						pageW = window.innerWidth,
						currIndex = 0;

					/**
					 * 根据判断view控件点击位置判断切换的tab
					 */
					nview.addEventListener('click', function(e) {
						var clientX = e.clientX;
						if(clientX > 0 && clientX <= parseInt(pageW * 0.25)) {
							currIndex = 0;
						} else if(clientX > parseInt(pageW * 0.25) && clientX <= parseInt(pageW * 0.45)) {
							currIndex = 1;
						} else if(clientX > parseInt(pageW * 0.45) && clientX <= parseInt(pageW * 0.8)) {
							currIndex = 2;
						} else {
							currIndex = 3;
						}
						// 匹配对应tab窗口	
						if(currIndex > 0) {
							targetPage = plus.webview.getWebviewById(subpages[currIndex - 1]);
						} else {
							targetPage = plus.webview.currentWebview();
						}

						if(targetPage == activePage) {
							return;
						}

						//底部选项卡切换
//						if(currIndex !== 3) {
							util.toggleNview(currIndex);
							// 子页面切换
							util.changeSubpage(targetPage, activePage, aniShow);
							//更新当前活跃的页面
							activePage = targetPage;
//						} else {
							//第四个tab 打开新窗口
//							plus.webview.open('html/main.html', 'new', {}, 'pop-in', 200);
//						}
					});
				});
			})();
		</script>
		<script type="text/javascript">
			var gallery = mui("#slider")
			gallery.slider({
				interval: 3000
			})

			mui(".mui-search")[0].addEventListener('click', function() {
				plus.webview.open('html/search.html', 'new', {}, 'slide-in-right', 200);
			})
		</script>
	</body>

</html>